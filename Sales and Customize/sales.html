<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales</title>
    <link rel="stylesheet" href="/Footer/footer.css">
    <link rel="stylesheet" href="./sales.css">
    <style>

    </style>
</head>
<body>
        <div id = "sale_topbar">
            <div>
                <p id = "sale_head"> Sale</p>
            </div>
            <div id = "sale_filter_sort"> 
              <div id = "filter_sec">
                <p>Show Filters</p>
                    <img id = "filter" src="https://cdn.iconscout.com/icon/free/png-64/filter-3583346-3007732.png" alt="">
              </div>
            
                <p id = "sort_by">Sort By:
                <div id = "sort_arrow">&#x276D;</div>
                </p>
          </div>
        </div>
        <div id = "sale_sorting_list"></div>
        <div>
            <div id = "filter_corner"></div>
            <div id = "sale_products"></div>
        </div>
        <div id = "customise_footer"></div>
</body>
</html>
<script type ="module">

    let products = JSON.parse(localStorage.getItem("sales_products"))||[]; // getting data from local Storage

    // IMPORT FUNCTION
    import {getdata,filter_cat} from './sales.js'
    import setdata from './nike_sale_data.js' 

    setdata() // calling setdata to store the details to the local storage 

   let product =  document.querySelector('#sale_products') // gettin element from HTML

    getdata(products,product) // adding parameter to imported funtion get data(data,location)

    sort_price() // calling sort_price to open sort section

    function sort_price() // SORT SECTION
    {   
        document.querySelector("#sort_arrow").addEventListener("click",() => // event listner
        {
            event.target.style.transform = "translate(-7px,25px) rotate(270deg)" // making arrow upwards

            document.querySelector("#sale_sorting_list").innerHTML = ""; // content inside sort section
            let low = document.createElement("h6")
            low.textContent = "Price: Low to High";
            let high = document.createElement("h6")
            high.textContent = "Price: High to Low";
            
            document.querySelector("#sale_sorting_list").append(low,high)
            
            document.querySelector("#sale_sorting_list").style.cssText =  // styles to sort body
            `background:white;
            width:130px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);`;
        

            document.querySelector("#sale_sorting_list").addEventListener("click",() => // event listner to sort body
            {
                
                products.sort(function(a,b){ //  sort funtion upon clicking 
                    
                    if(event.target.textContent == low.textContent) // if clicked low to high text
                    {
                        return Number(a.price) - Number(b.price)
            
                    }
                    else if(event.target.textContent == high.textContent) // if clicked on high to low
                    { 
                        let num = Number(a.price)
                        return Number(b.price) - Number(a.price)
                    }
                })
                getdata(products,product) // adding sorted data as parameter 

            })

            document.querySelector("#sort_arrow").addEventListener("click",() => // make arrow downwards upon clicking second time
            {
                event.target.style.transform = "translateY(30px) rotate(90deg)";
                document.querySelector("#sale_sorting_list").style.display = "none"; // not displaying
                sort_price()
            })
        })
    } 
    
    filter_it()

    function filter_it() //FILTER SECTION
    {
        document.querySelector("#filter").addEventListener("click",() =>
        {
            document.querySelector("#filter_sec > p").textContent = "Hide Filters";
            document.querySelector("#sale_products").style.width = "80%"

            let filter_box = document.querySelector("#filter_corner")

            filter_box.style.cssText = 
            `width:15%;
            margin-left:1%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
            height:290px;
            text-align:center;`;
            
            let category = document.createElement("h4")
            category.textContent = "Categories";

            let categories = document.createElement("div")
        
            filter_box.append(category)

            filter_cat(products,filter_box,categories,"Men")
            filter_cat(products,filter_box,categories,"Women")
            filter_cat(products,filter_box,categories,"Kids")
            filter_cat(products,filter_box,categories,"Shoes")
            filter_cat(products,filter_box,categories,"Shirts")

            document.querySelector("#filter").addEventListener("click",() =>
            {
                document.querySelector("#filter_sec > p").textContent = "Show Filters";
                filter_box.style.display = "none";
                document.querySelector("#sale_products").style.width = "95%";
                filter_box.innerHTML = "";
                filter_it()
            })
        })
    }  

    // FOOTER Section
    
    import footer from "/Footer/footer.js"

    let footer_styles = footer()
    document.querySelector("#customise_footer").innerHTML = footer_styles
</script>